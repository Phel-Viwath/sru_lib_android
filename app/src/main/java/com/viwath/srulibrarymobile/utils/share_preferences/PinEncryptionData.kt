/*
 * Copyright (c) 2025.
 * @Author Phel Viwath
 * All rights reserved.
 *
 */

package com.viwath.srulibrarymobile.utils.share_preferences

import android.content.Context
import android.util.Base64

class PinEncryptionData(context: Context) {
    private val preferences = SharedPreferencesHelper.getInstance(context)

    fun savePin(encryptedPin: ByteArray){
        preferences.putString(ENCRYPTED_PIN, Base64.encodeToString(encryptedPin, Base64.DEFAULT))
    }

    fun getEncryptedPin(): String? = preferences.getString(ENCRYPTED_PIN)
    fun getEncryptionIv(): String? = preferences.getString(ENCRYPTION_IV)

    fun clearPin(){
        preferences.clearValue(ENCRYPTED_PIN)
        preferences.clearValue(ENCRYPTION_IV)
    }


    companion object{
        private const val ENCRYPTED_PIN = "encrypted_pin"
        private const val ENCRYPTION_IV = "encryption_iv"
    }
}